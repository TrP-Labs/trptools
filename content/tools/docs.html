<!DOCTYPE html>

<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <link rel="stylesheet" type="text/css" href="/public/stylesheets/style.css">
        <link rel="icon" type="image/png" href="/public/favicon.ico">

        <title>TrP Tools - Docs</title>
        <meta property="og:type" content="website">
        <meta property="og:title" content="TrP Tools - Docs"/>
        <meta property="og:description" content="TrP Tools is an open source web service which aims to provide easy to use tools to the TrP community"/>
        <meta property="og:url" content="https://trptools.tickogrey.com"/>
        <meta property="og:image" content="/public/icon.png"/>

        <script src="/public/scripts/universalUtils.js"></script>    
        
        <script>
            document.addEventListener('DOMContentLoaded', function () {
    
                console.log('document loaded')
    
                fetch('/articles/get?type=officialDoc').then(response => {
                    return response.json()
                }).then(json => {
                    json.forEach(async mdbdocument => {
                        let name = await fetch('/proxy/name?id=' + mdbdocument.owner)
                        name = await name.json()

                        let data = `
                            <a href="/articles/${mdbdocument.id}">
                                <div class="frontbox">
                                    <h1 style="color: white;">${mdbdocument.title}</h1>
                                    <p style="color: white;">By ${name.data}</p>
                                </div>
                            </a>
                        `
    
                        const holder = document.getElementById('frontboxholder')
                        holder.innerHTML += data
                    })
                })
    
            });

            function postArticle() {
                window.location.href = "/articles/post?articleType=officialDoc"
            }
        </script>
    </head>

    <body>
        <!--Top Bar-->
        <div class="topnavsholder">
            <div class="topnav topnavholder">
                <a href="/">Tools</a>
                <a href="/articles/about">About</a>
                <a href="https://github.com/Ticko-Grey/trptools">Open Source</a>
            </div>

            <div class="topnav topnavholder nav-float" id="docsbuttonbar" style="flex-wrap: wrap;">
                <button class="inputbutton" style="background-color: #4CAF50;" onclick="postArticle()">Post Article</button>
            </div>

            <div class="topnav topnavholder nav-right">
                <a id="loginAccount" class="nav-full" href="/auth/login">Login</a>
            </div>
        </div>

        <div class="frontboxholder" id="frontboxholder">

        </div>
        
    </body>

    <script>
        function check() {
            if (loggedInUserSitePermissionLevel === null) { // basically repeat wait until 
                setTimeout(check, 50);
                return;
            }

            if (loggedInUserSitePermissionLevel <= 2) {
                document.getElementById('docsbuttonbar').remove();
            }
        }

        check()
    </script>
</html>